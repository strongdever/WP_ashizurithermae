var sowb=window.sowb||{};jQuery((function(o){sowb.setupAccordion=function(){o(".sow-accordion").each((function(n,a){var e=o(this).closest(".so-widget-sow-accordion");if(e.data("initialized"))return o(this);var i=o(a).find("> .sow-accordion-panel"),t=i.filter(".sow-accordion-panel-open").toArray(),c=function(){},r=function(n,a){var e=sowAccordion.scrollto_offset?sowAccordion.scrollto_offset:80,i=n.offset().top-e;a?o("body,html").animate({scrollTop:i},200):window.scrollTo(0,i)},s=function(n,a,e){var i=o(n);if(!i.is(".sow-accordion-panel-open")){i.find("> .sow-accordion-panel-content").slideDown({start:function(){sowAccordion.scrollto_after_change&&o(window).trigger("resize"),o(sowb).trigger("setup_widgets")},complete:function(){e&&sowAccordion.scrollto_after_change&&(i.offset().top<window.scrollY||i.offset().top+i.height()>window.scrollY)&&r(i,!0),o(this).trigger("show")}}),i.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!0),i.addClass("sow-accordion-panel-open"),t.push(n);var d=o(n).parents(".sow-accordion-panel");d.length&&!d.hasClass("sow-accordion-panel-open")&&s(d.get(0),!0),a||c()}},d=function(n,a){var e=o(n);e.is(".sow-accordion-panel-open")&&(e.find("> .sow-accordion-panel-content").slideUp((function(){o(this).trigger("hide")})),e.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").attr("aria-expanded",!1),e.removeClass("sow-accordion-panel-open"),t.splice(t.indexOf(n),1),a||c())};if(i.find("> .sow-accordion-panel-header-container > .sow-accordion-panel-header").on("click keydown",(function(n){if("keydown"==n.type){if(13!==n.keyCode&&32!==n.keyCode)return;n.preventDefault()}var a=o(this),i=e.data("maxOpenPanels"),c=a.closest(".sow-accordion-panel");if(c.is(".sow-accordion-panel-open")?d(c.get(0)):s(c.get(0),!1,!0),!isNaN(i)&&i>0&&t.length>i){var r=0;o.each(t.reverse(),(function(o,n){r!==i?r++:d(t[o])}))}})),e.data("anchor-id")||e.data("use-anchor-tags")){var l,w=!!e.data("anchor-id")&&e.data("anchor-id");c=function(){l&&clearTimeout(l),l=setTimeout((function(){for(var n=[],a=o(".sow-accordion-panel-open").toArray(),e=0;e<a.length;e++){var i=o(a[e]).data("anchor");if(w&&1!=w&&(i=w+"-"+i),i){var t=o(a[e]).parents(".sow-accordion-panel");(!t.length||t.length&&t.hasClass("sow-accordion-panel-open"))&&(n[e]=i)}}n&&n.length?window.location.hash=n.join(","):window.location.hash&&window.history.pushState("",document.title,window.location.pathname+window.location.search)}),100)};var h=function(){for(var n=i.toArray(),a=window.location.hash.substring(1).split(","),t=0;t<n.length;t++){var c=n[t],r=o(c).data("anchor"),l=!!e.data("anchor-id")&&e.data("anchor-id");l&&1!=l&&(r=e.data("anchor-id")+"-"+r),a.some((function(o){return decodeURI(r)===decodeURI(o)}))?s(c,!0,!0):d(c,!0)}};o(window).on("hashchange",h),window.location.hash?h():c();var p=e.data("initialScrollPanel");if(window.location.hash&&t.length)setTimeout((function(){r(o(t[0]))}),500);else if(p>0){var f=p>i.length?i.last():i.eq(p-1);setTimeout((function(){r(f)}),500)}}e.data("initialized",!0)}))},sowb.setupAccordion(),o(sowb).on("setup_widgets",sowb.setupAccordion)})),window.sowb=sowb;